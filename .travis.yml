stages:
  - test
  - deploy

language: node_js

node_js:
  - 12

cache:
  directores:
    - node_modules

install:
  - npm install -g npm@7.14.0
  - npm install -g @fleekhq/fleek-cli
  - npm install -g truffle
  - npm install

jobs:
  include:
    - stage: test
      name: "Test Smart Contracts"
      script:
        - truffle test
    - name: "Test Front-end"
      script:
        - truffle compile
        - cd client
        - npm test
    - stage: deploy
      script:
        - truffle compile
        - truffle migrate --network ropsten
        - cd client
        - npm run build
        - cd ..
        - fleek site:deploy









